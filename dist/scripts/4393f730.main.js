!function(){var a={};"development"===AppConfig.env&&(a={LOG_TRANSITIONS:!0,LOG_VIEW_LOOKUPS:!0,LOG_ACTIVE_GENERATION:!0});window.Noselus=Ember.Application.create(a)}(),function(){var a={};"development"===AppConfig.env&&(a={test:!0,debug:!0,verbose:!0}),Ember.Application.initializer({name:"initMixpanel",initialize:function(){mixpanel.set_config(a)}})}(),function(){!function(a,b,c){var d={};d.ControllerMixin=b.Mixin.create({loadingMore:!1,actions:{getMore:function(){this.get("loadingMore")||(this.set("loadingMore",!0),this.get("target").send("getMore"))},gotMore:function(){this.set("loadingMore",!1)}}}),d.RouteMixin=b.Mixin.create({actions:{getMore:function(){throw new Error("Must override Route action getMore.")},fetchPage:function(){throw new Error("Must override Route action getMore.")}}}),d.ViewMixin=b.Mixin.create({setupInfiniteScrollListener:function(){c("body").on("scroll",c.proxy(this.didScroll,this))},teardownInfiniteScrollListener:function(){c("body").off("scroll",c.proxy(this.didScroll,this))},didScroll:function(){this.isScrolledToBottom()&&this.get("controller").send("getMore")},isScrolledToBottom:function(){var b=c(document).height()-c(a).height(),d=c(document).scrollTop();return 0===d?!1:d-b===0},activateSpinner:function(){setTimeout(function(){c(".spinner").spin()},100)}.observes("controller.loadingMore")}),a.InfiniteScroll=d}(this,Ember,jQuery)}(),function(){moment.lang("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"une année",yy:"%d années"},ordinal:function(a){return a+(1===a?"er":"ème")},week:{dow:1,doy:4}})}(),function(){Ember.throttledObserver=function(a,b,c){return Em.observer(function(){Em.run.throttle(this,a,c)},b)}}(),function(){Ember.Handlebars.registerBoundHelper("clean-text",function(a){return a.replace(/^(<br \/\><br \/\>|<br\>|<br \/\>)/,"").htmlSafe()})}(),function(){Ember.Handlebars.registerBoundHelper("format-date",function(a){return moment(a,"YYYY-MM-DD").fromNow()})}(),function(){Noselus.ApplicationController=Ember.Controller.extend({routeChanged:function(){mixpanel.track_pageview(window.location.hash)}.observes("currentPath")})}(),function(){Noselus.HomepageController=Ember.ArrayController.extend({needs:["questions"],search:function(){var a=this,b=$(".search-field").val();a.get("controllers.questions").set("searchQuery",b),a.transitionToRoute("questions")}})}(),function(){Noselus.PoliticianController=Ember.ObjectController.extend(InfiniteScroll.ControllerMixin,{questions:[],searchQuery:null,isSearching:!1,searchQueryObserver:Ember.throttledObserver(function(){var a=this.get("searchQuery").split(" ").join("+");this.execQuery(a)},"searchQuery",600),execQuery:function(a){var b,c=20,d=this.get("model").get("id");b=""!==a?{q:a,limit:c,asked_by:d}:{limit:c,asked_by:d},this.updateContent(b)},updateContent:function(a){var b=this,c=b.store.find("question",a);c.then(function(a){b.set("isSearching",!1),b.set("questions",a)})},activateSpinner:function(){setTimeout(function(){$(".spinner").spin()},100)}.observes("isSearching")})}(),function(){Noselus.PoliticiansController=Ember.ArrayController.extend({searchQuery:null,isSearching:!1,searchQueryObserver:Ember.throttledObserver(function(){var a=this.get("searchQuery").toLowerCase();this.updateContent(a)},"searchQuery",600),updateContent:function(a){var b=this,c=new RegExp(a);b.clearResults();b.store.filter("politician",{},function(b){return""!==a?c.test(b.get("fullName").toLowerCase()):!0}).then(function(a){b.set("isSearching",!1),b.set("model",a)})},clearResults:function(){this.set("isSearching",!0),this.store.unloadAll("politician")}})}(),function(){Noselus.QuestionsController=Ember.ArrayController.extend(InfiniteScroll.ControllerMixin,{searchQuery:null,isSearching:!1,foundQuestionsTotal:function(){var a=this.store.metadataFor("question");return a.total}.property("model"),content:[],searchQueryObserver:Ember.throttledObserver(function(){var a=this.get("searchQuery").split(" ").join("+");this.execQuery(a)},"searchQuery",600),execQuery:function(a){var b,c=20;b=""!==a?{q:a,limit:c}:{limit:c},this.updateContent(b)},updateContent:function(a){var b=this,c=b.store.find("question",a);c.then(function(a){b.set("isSearching",!1),b.set("model",a)})},clearResults:function(){this.set("isSearching",!0),this.store.unloadAll("question")},activateSpinner:function(){setTimeout(function(){$(".spinner").spin()},100)}.observes("isSearching")})}(),function(){Noselus.ApplicationAdapter=DS.RESTAdapter.extend({host:AppConfig.apiAdapterUrl})}(),function(){var a=DS.attr;Noselus.Politician=DS.Model.extend({fullName:a("string"),party:a("string"),address:a("string"),postalCode:a("string"),town:a("string"),phone:a("string"),fax:a("string"),email:a("string"),site:a("string"),assembly:a("string"),thumb:function(){return AppConfig.apiAdapterUrl+"/politicians/"+this.get("id")+"/picture/300/300"}.property("id"),thumbImage:function(){return'<img src="'+AppConfig.apiAdapterUrl+"/politicians/"+this.get("id")+'/picture/100/100" class="avatar media-object img-circle thumbnail"/>'}.property("id"),backgroundThumb:function(){return'background-image: url("'+this.get("thumb")+'")'}.property("thumb")})}(),function(){var a=DS.attr;Noselus.Question=DS.Model.extend({title:a("string"),excerpt:a("string"),questionText:a("string"),answerText:a("string"),askedBy:a("number"),askedTo:a("number"),dateAsked:a("string"),askedByPolitician:function(){var a=this.store.find("politician",this.get("askedBy"));return a}.property(),askedToPolitician:function(){var a=this.store.find("politician",this.get("askedTo"));return a}.property(),questionHasAnswer:function(){return null!==this.get("answerText")?!0:!1}.property()})}(),function(){Noselus.PoliticianRoute=Ember.Route.extend({model:function(a){return this.store.find("politician",a.politician_id)},setupController:function(a,b){a.set("questions",this.store.find("question",{asked_by:b.id,limit:20})),a.set("model",b)},actions:{getMore:function(){var a,b=this.store.metadataFor("question"),c=b.next,d=b.limit||20;a=this.send("fetchPage",c,d)},fetchPage:function(a,b){var c=this,d={first_element:a,limit:b,asked_by:c.get("controller.model").get("id")},e=this.store.find("question",d);e.then(function(a){c.get("controller.questions.content").addObjects(a),c.get("controller").send("gotMore")})}}})}(),function(){Noselus.PoliticiansRoute=Ember.Route.extend({model:function(){return this.store.filter("politician",{},function(){return!0})}})}(),function(){Noselus.QuestionRoute=Ember.Route.extend({model:function(a){return this.store.find("question",a.question_id)},actions:{goBack:function(a){"questions"==Noselus.previousPath?this.transitionTo("questions"):this.transitionTo("politician",a)}}})}(),function(){Noselus.QuestionsRoute=Ember.Route.extend({model:function(){return this.store.find("question",{limit:20})},actions:{getMore:function(){var a,b=this.store.metadataFor("question"),c=b.next,d=b.limit||20;a=this.send("fetchPage",c,d)},fetchPage:function(a,b){var c,d=this,e=d.get("controller").get("searchQuery");c=e?{q:e,first_element:a,limit:b}:{first_element:a,limit:b};var f=this.store.find("question",c);f.then(function(a){d.get("controller.model").addObjects(a),d.get("controller").send("gotMore")})}}})}(),function(){Noselus.PoliticianView=Ember.View.extend(InfiniteScroll.ViewMixin,{templateName:"politician",classNames:["container"],didInsertElement:function(){$("body").animate({scrollTop:0},"fast"),$(window).on("scroll",$.proxy(this.didScroll,this)),$(".spinner").spin()},willDestroyElement:function(){$(window).off("scroll",$.proxy(this.didScroll,this))}})}(),function(){Noselus.PoliticiansView=Ember.View.extend({templateName:"politicians",classNames:["container"],didInsertElement:function(){$(".spinner").spin()}})}(),function(){Noselus.QuestionListView=Ember.View.extend({templateName:"question_list",tagName:"div",classNames:[""]})}(),function(){Noselus.QuestionView=Ember.View.extend({classNames:["container main-wrapper"],didInsertElement:function(){$("body").animate({scrollTop:0},"fast")}})}(),function(){Noselus.QuestionsView=Ember.View.extend(InfiniteScroll.ViewMixin,{templateName:"questions",classNames:["container"],didInsertElement:function(){$(window).on("scroll",$.proxy(this.didScroll,this)),$(".spinner").spin()},willDestroyElement:function(){$(window).off("scroll",$.proxy(this.didScroll,this))}})}(),function(){Noselus.Router.map(function(){this.route("homepage",{path:"/"}),this.resource("politicians"),this.resource("politician",{path:"/politicians/:politician_id"}),this.resource("questions"),this.resource("question",{path:"/questions/:question_id"})}),Noselus.Router.reopen({location:"hashbang"}),Ember.Route.reopen({deactivate:function(){var a=this.controllerFor("application");Noselus.previousPath=a.get("currentPath")}}),function(){var a=Ember.get,b=Ember.set;Ember.Location.registerImplementation("hashbang",Ember.HashLocation.extend({getURL:function(){return a(this,"location").hash.substr(2)},setURL:function(c){a(this,"location").hash="!"+c,b(this,"lastSetURL",c)},onUpdateURL:function(c){var d=this,e=Ember.guidFor(this);Ember.$(window).bind("hashchange.ember-location-"+e,function(){Ember.run(function(){var e=location.hash.substr(2);a(d,"lastSetURL")!==e&&(b(d,"lastSetURL",null),c(e))})})},formatURL:function(a){return"#!"+a}}))}()}();